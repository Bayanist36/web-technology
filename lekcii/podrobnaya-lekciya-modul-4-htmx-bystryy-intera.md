---
order: 5
title: "Подробная Лекция: Модуль 4. htmx: быстрый интерактив"
---

**Преподаватель:** \[Ваше Имя / Название Курса\]\
**Дата:** \[Дата проведения\]\
**Цель:** Познакомить студентов с современной библиотекой htmx как альтернативой тяжелым JavaScript-фреймворкам для создания динамических веб-интерфейсов без полного перехода на SPA. Научить использовать атрибуты htmx для отправки запросов, частичного обновления страницы и реализации прогрессивного улучшения.

---

## Часть 1: Введение и Теоретическая Основа (30 минут)

### 1\.1. Вступление: зачем нужен htmx? (10 минут)

**Преподаватель:** Добрый день, коллеги! На предыдущих трёх занятиях мы заложили прочный фундамент веб-разработки.\
-- В **Модуле 1** мы построили каркас сайта с помощью **HTML**.\
-- В **Модуле 2** мы оформили его, добавив стиль и красоту через **CSS**.\
-- В **Модуле 3** мы вдохнули в него жизнь, научив реагировать на действия пользователя с помощью **JavaScript**.

Но возникает закономерный вопрос: **а что дальше?** Как сделать так, чтобы наш сайт не просто мигал кнопками, а **динамически обновлял контент без перезагрузки всей страницы** -- как это делают современные приложения?

Традиционный путь -- это **SPA (Single Page Application)** на React, Vue или Angular. Но это сложный, многослойный подход, требующий глубокого понимания состояния, маршрутизации, управления данными и т.д.

А что, если мы скажем: **«А давайте вернёмся к гипертексту, но сделаем его динамическим»**?

Именно эту идею и воплощает библиотека **htmx**.

**Что такое htmx?**\
htmx -- это **лёгкая (всего \~15 КБ) JavaScript-библиотека**, которая **расширяет HTML новыми атрибутами**. Благодаря им вы можете отправлять AJAX-запросы, обновлять части страницы и реагировать на события -- **прямо в разметке, без написания ни строчки JavaScript-кода**.

**Почему это важно?**

-  **Простота:** Ваш код остаётся читаемым и декларативным.
-  **Быстрота разработки:** Нет необходимости писать обработчики событий, управлять состоянием, парсить JSON.
-  **Прогрессивное улучшение:** Сайт работает даже без JavaScript -- htmx просто «улучшает» его поведение.
-  **Серверный рендеринг:** Логика остаётся на сервере, что упрощает архитектуру и повышает безопасность.

Сегодня мы сделаем первый шаг в этом направлении и научимся создавать интерактивные интерфейсы, оставаясь в рамках привычного HTML.

---

### 1\.2. Подключение и базовые принципы (10 минут)

**Преподаватель:** Прежде чем писать код, давайте подключим htmx к нашему проекту.

**Как подключить htmx?**\
Самый простой способ -- через CDN. Откройте ваш файл `index.html` и добавьте следующий тег **перед закрывающим** `**\</body>**` (это стандартная практика для скриптов):

```html
<script src="https://unpkg.com/htmx.org@2.0.0"></script>
```

Вот и всё! Теперь ваш HTML-документ «знает» о новых атрибутах htmx.

**Как это работает под капотом?**\
Процесс очень похож на классический веб, но без перезагрузки:

1. Пользователь совершает действие (кликает по кнопке, отправляет форму).
2. htmx **перехватывает** это действие.
3. Он отправляет **HTTP-запрос** (GET, POST и др.) на сервер по указанному вами URL.
4. Сервер обрабатывает запрос и возвращает **готовый HTML-фрагмент** (не JSON!).
5. htmx **вставляет** этот фрагмент в указанное место на странице.

**Ключевая философия htmx:**

<note type="quote">

**«Сервер отвечает за логику и рендеринг. Клиент отвечает только за обновление DOM».**

</note>

Это полная противоположность SPA, где клиент (браузер) делает почти всю работу. htmx возвращает нас к идее **гипертекста**, но делает её современной и динамичной.

---

### 1\.3. Основные атрибуты htmx (10 минут)

**Преподаватель:** Теперь познакомимся с «волшебными» атрибутами, которые превращают статичный HTML в динамический интерфейс.

Вот самые важные из них:

-  `**hx-get="/url"**` **/** `**hx-post="/url"**`:\
   Указывает URL, на который нужно отправить GET- или POST-запрос. Это основа любого взаимодействия.

-  `**hx-trigger="событие"**`:\
   Определяет, **когда** отправлять запрос. По умолчанию для ссылок -- `click`, для форм -- `submit`. Но можно указать и другие события:

   -  `click` -- клик по элементу.
   -  `submit` -- отправка формы.
   -  `change` -- изменение значения (например, в `<select>`).
   -  `keyup` -- нажатие клавиши.
   -  `load` -- загрузка страницы.
   -  `keyup changed delay:300ms` -- отложенная отправка (очень полезно для поиска).

-  `**hx-target="#селектор"**`:\
   Указывает, **куда** поместить ответ от сервера. Это может быть любой CSS-селектор: `#my-div`, `.results`, `body` и т.д.

-  `**hx-swap="способ"**`:\
   Определяет, **как именно** вставить ответ. По умолчанию используется `innerHTML` (заменить содержимое). Другие варианты:

   -  `outerHTML` -- заменить сам элемент.
   -  `beforeend` -- вставить в конец содержимого.
   -  `afterbegin` -- вставить в начало содержимого.
   -  `delete` -- удалить элемент.

-  `**hx-indicator=".spinner"**`:\
   Указывает на элемент, который будет служить **индикатором загрузки**. htmx автоматически добавит ему класс `htmx-indicator` во время запроса, что позволяет легко его стилизовать и показывать/скрывать.

-  `**hx-boost="true"**`:\
   Это мощный атрибут для **прогрессивного улучшения**. Если добавить его к обычной ссылке или форме, htmx автоматически превратит их в AJAX-запросы, не требуя от вас указания `hx-get` или `hx-post`.

**Преподаватель:** Эти атрибуты -- ваши новые инструменты. С их помощью вы сможете создавать сложное поведение, оставаясь в рамках простого и понятного HTML.

## Часть 2: Практическая Часть в WebStorm (45 минут)

### 2.1. Подготовка проекта (10 минут)

**Преподаватель:** Теперь, когда мы понимаем теорию, давайте перейдём к практике. Мы будем работать в том же проекте, который вы создавали на предыдущих занятиях — ваша **адаптивная визитка**. Именно к ней мы и подключим htmx.

1.  **Откройте проект в WebStorm.** Убедитесь, что у вас есть файл `index.html` с базовой структурой.
2.  **Подключите htmx.** Откройте `index.html` и добавьте следующую строку **перед закрывающим тегом `</body>`**:
    ```html
    <script src="https://unpkg.com/htmx.org@2.0.0"></script>
    ```
    Это всё, что нужно для подключения! Никаких `npm install`, никаких сборок — просто один тег.

3.  **Создадим папку для фрагментов.** В корне проекта создайте новую папку и назовите её `fragments`. В ней мы будем хранить небольшие HTML-файлы, которые будут имитировать ответы от сервера. Это временная мера — в модулях 7–9 мы заменим их на настоящие серверные эндпоинты на Node.js + Express.

---

### 2.2. Практические задачи (35 минут)

**Преподаватель:** Давайте выполним три ключевые задачи, которые продемонстрируют мощь htmx.

#### **Задача A: Кнопка «Загрузить ещё» (10 минут)**

Цель: добавить динамическую подгрузку контента без перезагрузки страницы.

1.  В `index.html` создайте пустой список:
    ```html
    <div id="list">
      <ul id="items"></ul>
    </div>
    ```
2.  Под списком добавьте кнопку с атрибутами htmx:
    ```html
    <button 
      hx-get="/fragments/more-items.html" 
      hx-target="#items" 
      hx-swap="beforeend"
      hx-indicator=".spinner">
      Загрузить ещё
    </button>
    <div class="spinner" style="display:none;">Загрузка...</div>
    ```
    *   `hx-get` указывает, откуда брать данные.
    *   `hx-target` говорит, куда вставить ответ.
    *   `hx-swap="beforeend"` добавит новый элемент в конец списка.
    *   `hx-indicator` свяжет кнопку с индикатором загрузки.

3.  Создайте файл `fragments/more-items.html` и добавьте в него:
    ```html
    <li>Новый элемент из фрагмента</li>
    ```

4.  **Протестируйте:** Откройте `index.html` в браузере и нажмите кнопку. Вы увидите, как элемент появляется в списке, а надпись «Загрузка...» на мгновение показывается. Это и есть **частичное обновление**!

---

#### **Задача B: Форма комментария (15 минут)**

Цель: отправлять данные формы и обновлять интерфейс без перезагрузки.

1.  В `index.html` добавьте форму:
    ```html
    <form hx-post="/fragments/new-comment.html" 
          hx-target="#comments" 
          hx-swap="afterbegin">
      <input name="author" placeholder="Ваше имя" required>
      <textarea name="text" placeholder="Ваш комментарий" required></textarea>
      <button type="submit">Отправить</button>
    </form>
    <div id="comments"></div>
    ```
    Обратите внимание: мы используем `hx-post`, так как форма отправляет данные. Атрибут `name` у полей важен — именно он будет передан на «сервер».

2.  Создайте файл `fragments/new-comment.html`:
    ```html
    <div class="comment">
      <strong>Аноним</strong>
      <p>Это заглушка комментария</p>
    </div>
    ```
    (В реальном приложении сервер бы подставил настоящее имя и текст.)

3.  **Протестируйте:** Заполните форму и отправьте её. Новый комментарий появится **в начале** блока `#comments` (благодаря `afterbegin`), а страница **не перезагрузится**. Это уже полноценный интерактив!

---

#### **Задача C: Живой поиск (10 минут)**

Цель: реализовать поиск с отложенной отправкой запроса.

1.  Добавьте в `index.html` поле поиска:
    ```html
    <input 
      type="search" 
      name="q"
      hx-get="/fragments/search-results.html"
      hx-trigger="keyup changed delay:300ms"
      hx-target="#results"
      autocomplete="off"
      placeholder="Поиск...">
    <div id="results"></div>
    ```

2.  Создайте файл `fragments/search-results.html`:
    ```html
    <p>Результаты поиска для "запрос"</p>
    <ul>
      <li>Результат 1</li>
      <li>Результат 2</li>
    </ul>
    ```

3.  **Протестируйте:** Начните вводить текст в поле. Через 300 миллисекунд после остановки ввода подгрузятся «результаты». Атрибут `hx-trigger` с `delay:300ms` предотвращает спам запросами при каждом нажатии клавиши.

**Преподаватель:** Обратите внимание, как мало кода мы написали! Ни одной строчки JavaScript, а у нас уже есть три разных интерактивных элемента. Это и есть сила htmx.

## Часть 3: Мини-проект, ДЗ и Заключение (15 минут)

### 3.1. Мини-проект: «Чат-заготовка» (5 минут)

**Преподаватель:** Отлично! Теперь, когда вы освоили три ключевых паттерна, давайте соберём их в один небольшой, но целостный интерфейс — **чат-заготовку**. Это не полноценный чат с сервером, но он будет выглядеть и вести себя как настоящий, благодаря htmx.

**Цель проекта:** Создать интерфейс, в котором можно:
- Отправлять новые сообщения без перезагрузки.
- Подгружать историю сообщений по кнопке.
- Видеть индикатор загрузки во время запросов.

**Требования к разметке в `index.html`:**
1.  **Список сообщений:**
    ```html
    <div id="chat-messages" class="chat-messages">
      <!-- Сюда будут подгружаться сообщения -->
    </div>
    ```
2.  **Форма отправки:**
    ```html
    <form hx-post="/fragments/new-message.html"
          hx-target="#chat-messages"
          hx-swap="afterbegin"
          hx-indicator="#send-indicator">
      <input type="text" name="message" placeholder="Введите сообщение..." required>
      <button type="submit">Отправить</button>
      <span id="send-indicator" class="indicator" style="display:none;">Отправка...</span>
    </form>
    ```
3.  **Кнопка загрузки истории:**
    ```html
    <button hx-get="/fragments/history.html"
            hx-target="#chat-messages"
            hx-swap="beforeend"
            hx-indicator="#load-indicator">
      Загрузить историю
    </button>
    <span id="load-indicator" class="indicator" style="display:none;">Загрузка...</span>
    ```

**Файлы-заглушки в папке `fragments/`:**
- `new-message.html`:
  ```html
  <div class="message">
    <strong>Вы:</strong> Это новое сообщение
  </div>
  ```
- `history.html`:
  ```html
  <div class="message"><strong>Алиса:</strong> Привет!</div>
  <div class="message"><strong>Боб:</strong> Как дела?</div>
  ```

**План выполнения:**
1.  Добавьте всю разметку в `index.html`.
2.  Создайте папку `fragments` и два HTML-файла внутри.
3.  Убедитесь, что htmx подключён.
4.  Откройте страницу в браузере и протестируйте обе функции.

Этот проект — отличная основа для будущего, когда в модулях 7–9 мы заменим заглушки на настоящие эндпоинты на Express.

---

### 3.2. Домашнее задание (3 минуты)

**Преподаватель:** Чтобы закрепить материал, выполните следующее домашнее задание.

**Задание:** Доработать мини-проект «Чат-заготовка».

**Требования:**
1.  Добавьте **индикаторы загрузки** для обеих операций (отправка и загрузка истории), как показано выше.
2.  Создайте **три HTML-заглушки** в папке `fragments`:
    *   `pagination.html` — для подгрузки дополнительных сообщений.
    *   `new-message.html` — для отправки нового сообщения.
    *   `search-results.html` — для реализации поиска по чату (опционально, но желательно).
3.  Убедитесь, что всё работает корректно: сообщения появляются в нужном месте, индикаторы показываются и скрываются.

**Критерии оценки:**
*   **Оценка 5 (Отлично):** Все элементы работают, индикаторы есть и функционируют, заглушки созданы и корректны.
*   **Оценка 4 (Хорошо):** Есть мелкие недочёты (например, индикатор не скрывается, или заглушка возвращает не тот HTML).
*   **Оценка 3 (Удовлетворительно):** Реализована только часть функционала (например, только форма или только кнопка).

**Срок сдачи:** [Укажите дату].

---

### 3.3. Контрольные вопросы и Заключение (7 минут)

**Преподаватель:** Давайте подведём итоги и проверим, насколько хорошо вы усвоили материал. Я задам несколько вопросов.

**Контрольные вопросы:**

1.  **В чём главная идея htmx?**  
    *Ответ:* Вернуть динамику в гипертекст, позволяя обновлять части страницы через HTML-атрибуты без написания JavaScript.

2.  **Какой атрибут указывает, куда вставить ответ от сервера?**  
    *Ответ:* `hx-target`.

3.  **Почему сервер должен возвращать HTML, а не JSON?**  
    *Ответ:* Потому что htmx предназначен для вставки готового HTML-фрагмента прямо в DOM. Это упрощает серверную логику и делает фронтенд декларативным.

4.  **Как сделать так, чтобы запрос отправлялся не сразу при вводе, а с задержкой?**  
    *Ответ:* Использовать `hx-trigger="keyup changed delay:300ms"`.

**Заключение:**

**Преподаватель:** Сегодня мы совершили важный шаг вперёд. Мы познакомились с **htmx** — современным, лёгким и элегантным подходом к созданию интерактивных веб-интерфейсов. Вы увидели, как можно достичь значительной функциональности, оставаясь в рамках простого HTML, без сложных фреймворков и сотен строк JavaScript.

htmx — это не замена React или Vue, а **альтернативная философия**. Он идеально подходит для:
- Быстрой прототипизации.
- Проектов с сильным акцентом на серверный рендеринг.
- Сайтов, где важна простота и прогрессивное улучшение.

В следующем **Модуле 5** мы познакомимся с **React** — другим, противоположным подходом, основанным на компонентах и клиентском рендеринге. Сравнивая эти два подхода, вы сможете осознанно выбирать инструмент под задачу.

**Спасибо за внимание!** Удачи в выполнении домашнего задания. Не забывайте: ваш чат — это не просто учебный проект, это первый шаг к полноценному веб-приложению!